# Правила работы с проектом "Третий пехотный полк"

## Структура проекта

- **index.html** - ЕДИНСТВЕННЫЙ файл с ВСЕЙ логикой игры:
  - HTML разметка (canvas с id="game", панель справа)
  - CSS стили (внутри `<style>`)
  - ВСЯ логика игры в одном `<script>`:
    - player, enemies, portals, arrows
    - уровни, звуки, коллизии
    - загрузка спрайтов
    - тестовые функции

- **assets/** - папка со спрайтами и ресурсами:
  - `player.png` - спрайт игрока

## КРИТИЧЕСКИ ВАЖНО

❗ **ВСЁ должно остаться в ОДНОМ файле index.html**

- ❌ НЕ создавать отдельные .js файлы
- ❌ НЕ выносить код в game.js или другие файлы
- ✅ ВСЯ логика должна быть внутри `<script>` в index.html
- ✅ Единственные внешние ресурсы - изображения в assets/

## Правила изменений

1. **Загрузка спрайтов:**
   - Объект `images` должен быть объявлен сразу после получения `ctx`
   - Загрузка спрайтов через `new Image()` с обработкой ошибок
   - Если спрайт не загрузился - должен работать fallback (старое поведение)

2. **Функция drawPlayer():**
   - Логика с `playerDeathAnimation` НЕ меняется
   - Если `images.player` загружен - рисуем спрайт
   - Если спрайт не загружен - fallback на круг с направлением

3. **Сохранение логики:**
   - gameLoop, враги, порталы, стрелы остаются без изменений
   - Тестовые функции (runCollisionTests, runPortalTests, runMapVisualizationTests) не трогать
   - Вся игровая логика должна работать как раньше

## Структура скрипта

```javascript
// 1. Получение элементов DOM
const canvas = document.getElementById('game');
const ctx = canvas.getContext('2d');

// 2. Загрузка изображений (сразу после ctx)
const images = { player: null };
// ... загрузка спрайтов

// 3. Остальные элементы DOM
const livesDisplay = ...
// ...

// 4. Игровая логика
const player = ...
// ...

// 5. Функции отрисовки
function drawPlayer() { ... }
// ...
```

## При работе с проектом

- Все изменения только внутри `<script>` в index.html
- Не создавать новые файлы
- Сохранять структуру и логику игры
- Обеспечивать fallback для всех загружаемых ресурсов

